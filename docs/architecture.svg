<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" font-family="'Inter','Helvetica Neue',sans-serif" font-size="12">
  <defs>
    <style>
      .title { font-size: 20px; font-weight: 700; fill: #f0f0f0; }
      .subtitle { font-size: 12px; fill: #909090; }
      .dir-label { font-size: 14px; font-weight: 700; fill: #e8e8e8; }
      .file-name { font-size: 12px; font-weight: 500; fill: #d0d0d0; font-family: 'SF Mono','Fira Code',monospace; }
      .file-desc { font-size: 11px; fill: #999; }
      .missing-name { font-size: 12px; font-weight: 500; fill: #f0a040; font-family: 'SF Mono','Fira Code',monospace; }
      .missing-desc { font-size: 11px; fill: #c08030; }
      .section-label { font-size: 11px; fill: #b0b0b0; font-weight: 600; letter-spacing: 1px; }
      .info-label { font-size: 12px; font-weight: 600; fill: #d0d0d0; }
      .info-desc { font-size: 11px; fill: #999; }
      .badge { font-size: 10px; fill: #ddd; font-weight: 600; }
      .connector { stroke: #777; stroke-width: 1.5; fill: none; }
      .step-box { fill: #1e1e1e; stroke: #484848; stroke-width: 1; }
      .step-name { font-size: 11px; font-weight: 600; fill: #e0e0e0; font-family: 'SF Mono','Fira Code',monospace; }
      .step-detail { font-size: 10px; fill: #999; }
      .arrow-h { stroke: #777; stroke-width: 1.2; fill: none; }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" rx="10" fill="#111111"/>

  <!-- Title bar -->
  <rect x="0" y="0" width="1200" height="60" rx="10" fill="#181818"/>
  <rect x="0" y="50" width="1200" height="10" fill="#181818"/>
  <text x="36" y="32" class="title">agent-prompts v3</text>
  <text x="36" y="48" class="subtitle">Final Agent = Workflow step + Core prompt + Included docs + Template resolution</text>

  <!-- Legend -->
  <circle cx="1040" cy="28" r="5" fill="#8a8"/>
  <text x="1052" y="32" class="file-desc">Done</text>
  <circle cx="1110" cy="28" r="5" fill="#e08a30"/>
  <text x="1122" y="32" class="file-desc">Planned</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- PROMPTS PANEL  (y=70, h=610, bottom=680)                   -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="20" y="70" width="580" height="610" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="40" y="96" class="dir-label">prompts/</text>
  <text x="120" y="96" class="subtitle">Atomic, reusable instruction modules</text>

  <!-- ── tech/ (y=112, h=230, bottom=342) ── -->
  <rect x="36" y="112" width="548" height="230" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <text x="52" y="134" class="section-label">DO</text>
  <rect x="78" y="122" width="52" height="18" rx="9" fill="#3a3a3a"/>
  <text x="88" y="135" class="badge">core</text>

  <circle cx="52" cy="160" r="4" fill="#8a8"/>
  <text x="64" y="164" class="file-name">plan.md</text>
  <text x="280" y="164" class="file-desc">Explore codebase, produce implementation plan</text>

  <circle cx="52" cy="184" r="4" fill="#8a8"/>
  <text x="64" y="188" class="file-name">implement.md</text>
  <text x="280" y="188" class="file-desc">Execute changes, quality gates, commit</text>

  <circle cx="52" cy="208" r="4" fill="#8a8"/>
  <text x="64" y="212" class="file-name">review.md</text>
  <text x="280" y="212" class="file-desc">Review diff, PASS/FAIL verdict</text>

  <circle cx="52" cy="232" r="4" fill="#8a8"/>
  <text x="64" y="236" class="file-name">qa.md</text>
  <text x="280" y="236" class="file-desc">Write tests, run suite, verify coverage</text>

  <circle cx="52" cy="256" r="4" fill="#8a8"/>
  <text x="64" y="260" class="file-name">architect.md</text>
  <text x="280" y="260" class="file-desc">System design, ADRs, Mermaid diagrams</text>

  <circle cx="52" cy="280" r="4" fill="#8a8"/>
  <text x="64" y="284" class="file-name">security-review.md</text>
  <text x="280" y="284" class="file-desc">STRIDE threat model, JSON findings</text>

  <circle cx="52" cy="304" r="4" fill="#8a8"/>
  <text x="64" y="308" class="file-name">sre.md</text>
  <text x="280" y="308" class="file-desc">Observe-Hypothesize-Verify-Fix diagnosis</text>

  <!-- ── stacks/ (y=354, h=130, bottom=484) ── -->
  <rect x="36" y="354" width="548" height="130" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <text x="52" y="376" class="section-label">STACKS</text>
  <rect x="104" y="364" width="56" height="18" rx="9" fill="#3a3a3a"/>
  <text x="114" y="377" class="badge">stack</text>

  <circle cx="52" cy="400" r="4" fill="#8a8"/>
  <text x="64" y="404" class="file-name">rust.md</text>
  <text x="280" y="404" class="file-desc">Rust idioms, clippy, cargo test</text>

  <circle cx="52" cy="424" r="4" fill="#8a8"/>
  <text x="64" y="428" class="file-name">astro.md</text>
  <text x="280" y="428" class="file-desc">Astro/TypeScript, bun, CSS variables</text>

  <circle cx="52" cy="448" r="4" fill="#8a8"/>
  <text x="64" y="452" class="file-name">aws.md</text>
  <text x="280" y="452" class="file-desc">Terraform IaC, AWS services, tfsec</text>

  <circle cx="52" cy="472" r="4" fill="#8a8"/>
  <text x="64" y="476" class="file-name">mise.md</text>
  <text x="280" y="476" class="file-desc">Tool versions, monorepo, task runner</text>

  <!-- ── pm/ (y=496, h=82, bottom=578) ── -->
  <rect x="36" y="496" width="548" height="82" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <text x="52" y="518" class="section-label">PM</text>
  <rect x="78" y="506" width="38" height="18" rx="9" fill="#3a3a3a"/>
  <text x="86" y="519" class="badge">pm</text>

  <circle cx="52" cy="542" r="4" fill="#8a8"/>
  <text x="64" y="546" class="file-name">github-project-manager.md</text>
  <text x="320" y="546" class="file-desc">PRD decomposition, epics, board</text>

  <circle cx="52" cy="564" r="4" fill="#8a8"/>
  <text x="64" y="568" class="file-name">github-issue.md</text>
  <text x="320" y="568" class="file-desc">Dev gh CLI: view, comment, close</text>

  <!-- ── biz/ (y=590, h=66, bottom=656) ── -->
  <rect x="36" y="590" width="548" height="66" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <text x="52" y="612" class="section-label">BIZ</text>
  <rect x="78" y="600" width="40" height="18" rx="9" fill="#3a3a3a"/>
  <text x="86" y="613" class="badge">biz</text>

  <circle cx="52" cy="636" r="4" fill="#8a8"/>
  <text x="64" y="640" class="file-name">gtm.md</text>
  <text x="280" y="640" class="file-desc">Go-to-market, messaging, positioning</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- WORKFLOWS PANEL  (y=70, h=540, bottom=610)                -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="620" y="70" width="560" height="540" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="640" y="96" class="dir-label">workflows/</text>
  <text x="728" y="96" class="subtitle">Short sessions, tight context — orchestrator dispatches</text>

  <!-- prd-to-issue.toml (y=112, h=90) -->
  <rect x="636" y="112" width="528" height="90" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <circle cx="648" cy="132" r="4" fill="#8a8"/>
  <text x="660" y="136" class="file-name">prd-to-issue.toml</text>
  <text x="830" y="136" class="file-desc">PRD in, GitHub Issues out</text>

  <rect x="652" y="152" width="160" height="38" rx="4" class="step-box"/>
  <text x="672" y="170" class="step-name">decompose</text>
  <text x="660" y="184" class="step-detail">prompts/pm/github-project-manager.md</text>

  <!-- precise-context.toml (y=214, h=90) -->
  <rect x="636" y="214" width="528" height="90" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <circle cx="648" cy="234" r="4" fill="#8a8"/>
  <text x="660" y="238" class="file-name">precise-context.toml</text>
  <text x="830" y="238" class="file-desc">Issue in, XML context to issue</text>

  <rect x="652" y="254" width="130" height="38" rx="4" class="step-box"/>
  <text x="672" y="272" class="step-name">plan</text>
  <text x="660" y="286" class="step-detail">prompts/do/plan.md</text>

  <text x="796" y="278" class="step-detail">include = [] (caller-provided)</text>

  <!-- develop-feature.toml (y=316, h=110) -->
  <rect x="636" y="316" width="528" height="110" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <circle cx="648" cy="336" r="4" fill="#8a8"/>
  <text x="660" y="340" class="file-name">develop-feature.toml</text>
  <text x="830" y="340" class="file-desc">Issue+context in, code committed</text>

  <rect x="652" y="356" width="114" height="38" rx="4" class="step-box"/>
  <text x="672" y="374" class="step-name">implement</text>
  <text x="660" y="388" class="step-detail">prompts/do/implement.md</text>

  <line x1="766" y1="375" x2="784" y2="375" class="arrow-h"/>
  <polygon points="781,372 788,375 781,378" fill="#777"/>

  <rect x="788" y="356" width="90" height="38" rx="4" class="step-box"/>
  <text x="818" y="374" class="step-name">qa</text>
  <text x="798" y="388" class="step-detail">prompts/do/qa.md</text>

  <!-- loop back arrow: qa FAIL → implement -->
  <path d="M833,394 L833,410 L709,410 L709,394" class="arrow-h" fill="none"/>
  <polygon points="705,397 709,390 713,397" fill="#777"/>
  <text x="736" y="420" class="step-detail">on_fail (max 3)</text>
  <text x="900" y="378" class="step-detail">include = [] (caller-provided)</text>

  <!-- issue-review.toml (y=438, h=110) -->
  <rect x="636" y="438" width="528" height="110" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <circle cx="648" cy="458" r="4" fill="#8a8"/>
  <text x="660" y="462" class="file-name">issue-review.toml</text>
  <text x="830" y="462" class="file-desc">Code reviewed, verdict out</text>

  <rect x="652" y="478" width="130" height="38" rx="4" class="step-box"/>
  <text x="672" y="496" class="step-name">review</text>
  <text x="660" y="510" class="step-detail">prompts/do/review.md</text>

  <rect x="800" y="478" width="170" height="38" rx="4" class="step-box"/>
  <text x="820" y="496" class="step-name">security-review</text>
  <text x="808" y="510" class="step-detail">prompts/do/security-review.md</text>

  <text x="660" y="538" class="step-detail">parallel (no depends_on) — diagnostic only, verdict to orchestrator</text>

  <!-- Orchestration flow arrow between workflows -->
  <line x1="636" y1="202" x2="636" y2="214" class="connector"/>
  <polygon points="632,211 636,218 640,211" fill="#777"/>
  <line x1="636" y1="304" x2="636" y2="316" class="connector"/>
  <polygon points="632,313 636,320 640,313" fill="#777"/>
  <line x1="636" y1="426" x2="636" y2="438" class="connector"/>
  <polygon points="632,435 636,442 640,435" fill="#777"/>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- COMPOSITION FLOW  (y=630, h=250, bottom=880)              -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="620" y="630" width="270" height="250" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="640" y="656" class="dir-label">Composition Flow</text>

  <rect x="640" y="672" width="230" height="32" rx="5" fill="#1a1a1a" stroke="#484848" stroke-width="1"/>
  <text x="656" y="693" class="info-label">1. prompt_file</text>

  <line x1="755" y1="704" x2="755" y2="714" class="connector"/>
  <polygon points="751,711 755,718 759,711" fill="#777"/>

  <rect x="640" y="718" width="230" height="32" rx="5" fill="#1a1a1a" stroke="#484848" stroke-width="1"/>
  <text x="656" y="739" class="info-label">2. each include[] entry</text>

  <line x1="755" y1="750" x2="755" y2="760" class="connector"/>
  <polygon points="751,757 755,764 759,757" fill="#777"/>

  <rect x="640" y="764" width="230" height="32" rx="5" fill="#1a1a1a" stroke="#484848" stroke-width="1"/>
  <text x="656" y="785" class="info-label">3. Template resolution</text>

  <line x1="755" y1="796" x2="755" y2="806" class="connector"/>
  <polygon points="751,803 755,810 759,803" fill="#777"/>

  <rect x="705" y="810" width="120" height="24" rx="12" fill="#8a8"/>
  <text x="731" y="826" font-size="12" font-weight="600" fill="#111">Final Agent</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- TEMPLATE VARIABLES  (y=630, h=160, bottom=790)            -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="910" y="630" width="270" height="160" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="930" y="656" class="dir-label">Template Variables</text>

  <text x="930" y="680" class="file-name" font-size="11">{{mission}}</text>
  <text x="1070" y="680" class="info-desc">Task goal</text>

  <text x="930" y="700" class="file-name" font-size="11">{{prd}}</text>
  <text x="1070" y="700" class="info-desc">PRD document</text>

  <text x="930" y="720" class="file-name" font-size="11">{{worktree_path}}</text>
  <text x="1070" y="720" class="info-desc">Working dir</text>

  <text x="930" y="740" class="file-name" font-size="11">{{context}}</text>
  <text x="1070" y="740" class="info-desc">Project context</text>

  <text x="930" y="760" class="file-name" font-size="11">{{github_repo}}</text>
  <text x="1070" y="760" class="info-desc">owner/repo</text>

  <text x="930" y="780" class="file-name" font-size="11">{{github_issue}}</text>
  <text x="1070" y="780" class="info-desc">Issue number</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- PROGRESS  (y=830, h=50, bottom=880)                       -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="20" y="830" width="280" height="50" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="40" y="854" class="dir-label">Progress</text>
  <text x="130" y="854" class="subtitle">18/18  |  prompts: 14  |  workflows: 4</text>
  <rect x="40" y="864" width="240" height="6" rx="3" fill="#222"/>
  <rect x="40" y="864" width="240" height="6" rx="3" fill="#8a8"/>

</svg>
