<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" font-family="'Inter','Helvetica Neue',sans-serif" font-size="12">
  <defs>
    <style>
      .title { font-size: 20px; font-weight: 700; fill: #f0f0f0; }
      .subtitle { font-size: 12px; fill: #909090; }
      .dir-label { font-size: 14px; font-weight: 700; fill: #e8e8e8; }
      .file-name { font-size: 12px; font-weight: 500; fill: #d0d0d0; font-family: 'SF Mono','Fira Code',monospace; }
      .file-desc { font-size: 11px; fill: #999; }
      .missing-name { font-size: 12px; font-weight: 500; fill: #f0a040; font-family: 'SF Mono','Fira Code',monospace; }
      .missing-desc { font-size: 11px; fill: #c08030; }
      .section-label { font-size: 11px; fill: #b0b0b0; font-weight: 600; letter-spacing: 1px; }
      .info-label { font-size: 12px; font-weight: 600; fill: #d0d0d0; }
      .info-desc { font-size: 11px; fill: #999; }
      .badge { font-size: 10px; fill: #ddd; font-weight: 600; }
      .connector { stroke: #777; stroke-width: 1.5; fill: none; }
      .step-box { fill: #1e1e1e; stroke: #484848; stroke-width: 1; }
      .step-name { font-size: 11px; font-weight: 600; fill: #e0e0e0; font-family: 'SF Mono','Fira Code',monospace; }
      .step-detail { font-size: 10px; fill: #999; }
      .arrow-h { stroke: #777; stroke-width: 1.2; fill: none; }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" rx="10" fill="#111111"/>

  <!-- Title bar -->
  <rect x="0" y="0" width="1200" height="60" rx="10" fill="#181818"/>
  <rect x="0" y="50" width="1200" height="10" fill="#181818"/>
  <text x="36" y="32" class="title">agent-prompts v2</text>
  <text x="36" y="48" class="subtitle">Final Agent = Workflow step + Core prompt + Stack prompt + Template resolution</text>

  <!-- Legend -->
  <circle cx="1040" cy="28" r="5" fill="#8a8"/>
  <text x="1052" y="32" class="file-desc">Done</text>
  <circle cx="1110" cy="28" r="5" fill="#e08a30"/>
  <text x="1122" y="32" class="file-desc">Planned</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- PROMPTS PANEL  (y=70, h=610, bottom=680)                   -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="20" y="70" width="580" height="610" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="40" y="96" class="dir-label">prompts/</text>
  <text x="120" y="96" class="subtitle">Atomic, reusable instruction modules</text>

  <!-- ── tech/ (y=112, h=230, bottom=342) ── -->
  <rect x="36" y="112" width="548" height="230" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <text x="52" y="134" class="section-label">DO</text>
  <rect x="78" y="122" width="52" height="18" rx="9" fill="#3a3a3a"/>
  <text x="88" y="135" class="badge">core</text>

  <circle cx="52" cy="160" r="4" fill="#8a8"/>
  <text x="64" y="164" class="file-name">plan.md</text>
  <text x="280" y="164" class="file-desc">Explore codebase, produce implementation plan</text>

  <circle cx="52" cy="184" r="4" fill="#8a8"/>
  <text x="64" y="188" class="file-name">implement.md</text>
  <text x="280" y="188" class="file-desc">Execute changes, quality gates, commit</text>

  <circle cx="52" cy="208" r="4" fill="#8a8"/>
  <text x="64" y="212" class="file-name">review.md</text>
  <text x="280" y="212" class="file-desc">Review diff, PASS/FAIL verdict</text>

  <circle cx="52" cy="232" r="4" fill="#8a8"/>
  <text x="64" y="236" class="file-name">qa.md</text>
  <text x="280" y="236" class="file-desc">Write tests, run suite, verify coverage</text>

  <circle cx="52" cy="256" r="4" fill="#8a8"/>
  <text x="64" y="260" class="file-name">architect.md</text>
  <text x="280" y="260" class="file-desc">System design, ADRs, Mermaid diagrams</text>

  <circle cx="52" cy="280" r="4" fill="#8a8"/>
  <text x="64" y="284" class="file-name">security-review.md</text>
  <text x="280" y="284" class="file-desc">STRIDE threat model, JSON findings</text>

  <circle cx="52" cy="304" r="4" fill="#8a8"/>
  <text x="64" y="308" class="file-name">sre.md</text>
  <text x="280" y="308" class="file-desc">Observe-Hypothesize-Verify-Fix diagnosis</text>

  <!-- ── stacks/ (y=354, h=130, bottom=484) ── -->
  <rect x="36" y="354" width="548" height="130" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <text x="52" y="376" class="section-label">STACKS</text>
  <rect x="104" y="364" width="56" height="18" rx="9" fill="#3a3a3a"/>
  <text x="114" y="377" class="badge">stack</text>

  <circle cx="52" cy="400" r="4" fill="#8a8"/>
  <text x="64" y="404" class="file-name">rust.md</text>
  <text x="280" y="404" class="file-desc">Rust idioms, clippy, cargo test</text>

  <circle cx="52" cy="424" r="4" fill="#8a8"/>
  <text x="64" y="428" class="file-name">astro.md</text>
  <text x="280" y="428" class="file-desc">Astro/TypeScript, bun, CSS variables</text>

  <circle cx="52" cy="448" r="4" fill="#8a8"/>
  <text x="64" y="452" class="file-name">aws.md</text>
  <text x="280" y="452" class="file-desc">Terraform IaC, AWS services, tfsec</text>

  <circle cx="52" cy="472" r="4" fill="#8a8"/>
  <text x="64" y="476" class="file-name">mise.md</text>
  <text x="280" y="476" class="file-desc">Tool versions, monorepo, task runner</text>

  <!-- ── pm/ (y=496, h=82, bottom=578) ── -->
  <rect x="36" y="496" width="548" height="82" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <text x="52" y="518" class="section-label">PM</text>
  <rect x="78" y="506" width="38" height="18" rx="9" fill="#3a3a3a"/>
  <text x="86" y="519" class="badge">pm</text>

  <circle cx="52" cy="542" r="4" fill="#8a8"/>
  <text x="64" y="546" class="file-name">github-project-manager.md</text>
  <text x="320" y="546" class="file-desc">PRD decomposition, epics, board</text>

  <circle cx="52" cy="564" r="4" fill="#8a8"/>
  <text x="64" y="568" class="file-name">github-issue.md</text>
  <text x="320" y="568" class="file-desc">Dev gh CLI: view, comment, close</text>

  <!-- ── biz/ (y=590, h=66, bottom=656) ── -->
  <rect x="36" y="590" width="548" height="66" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <text x="52" y="612" class="section-label">BIZ</text>
  <rect x="78" y="600" width="40" height="18" rx="9" fill="#3a3a3a"/>
  <text x="86" y="613" class="badge">biz</text>

  <circle cx="52" cy="636" r="4" fill="#8a8"/>
  <text x="64" y="640" class="file-name">gtm.md</text>
  <text x="280" y="640" class="file-desc">Go-to-market, messaging, positioning</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- WORKFLOWS PANEL  (y=70, h=360, bottom=430)                -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="620" y="70" width="560" height="360" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="640" y="96" class="dir-label">workflows/</text>
  <text x="728" y="96" class="subtitle">Steps reference prompts/ directly — no roles layer</text>

  <!-- dev-task.toml (y=112, h=168, bottom=280) -->
  <rect x="636" y="112" width="528" height="168" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <circle cx="648" cy="132" r="4" fill="#8a8"/>
  <text x="660" y="136" class="file-name">dev-task.toml</text>
  <text x="800" y="136" class="file-desc">stack = "rust" | "astro"</text>

  <!-- step boxes row -->
  <rect x="652" y="152" width="100" height="44" rx="4" class="step-box"/>
  <text x="672" y="170" class="step-name">plan</text>
  <text x="660" y="186" class="step-detail">do/plan.md</text>

  <line x1="752" y1="174" x2="770" y2="174" class="arrow-h"/>
  <polygon points="767,171 774,174 767,177" fill="#777"/>

  <rect x="774" y="152" width="114" height="44" rx="4" class="step-box"/>
  <text x="794" y="170" class="step-name">implement</text>
  <text x="782" y="186" class="step-detail">do/implement.md</text>

  <line x1="888" y1="174" x2="906" y2="174" class="arrow-h"/>
  <polygon points="903,171 910,174 903,177" fill="#777"/>

  <rect x="910" y="152" width="90" height="44" rx="4" class="step-box"/>
  <text x="940" y="170" class="step-name">qa</text>
  <text x="920" y="186" class="step-detail">do/qa.md</text>

  <line x1="1000" y1="174" x2="1018" y2="174" class="arrow-h"/>
  <polygon points="1015,171 1022,174 1015,177" fill="#777"/>

  <rect x="1022" y="152" width="126" height="44" rx="4" class="step-box"/>
  <text x="1058" y="170" class="step-name">review</text>
  <text x="1036" y="186" class="step-detail">do/review.md</text>

  <!-- stack annotation -->
  <text x="660" y="218" class="step-detail">+ stacks/rust.md inherited on implement, qa, review</text>

  <!-- workflow step structure -->
  <line x1="652" y1="234" x2="1148" y2="234" stroke="#444" stroke-width="0.5" stroke-dasharray="4,3"/>
  <text x="660" y="252" class="info-desc">step.prompt_file -> prompts/ file</text>
  <text x="660" y="268" class="info-desc">workflow.stack -> inherited by all steps (overridable)</text>

  <!-- pm-epic.toml (y=292, h=124, bottom=416) -->
  <rect x="636" y="292" width="528" height="124" rx="6" fill="#1a1a1a" stroke="#444" stroke-width="1"/>
  <circle cx="648" cy="312" r="4" fill="#8a8"/>
  <text x="660" y="316" class="file-name">pm-epic.toml</text>
  <text x="800" y="316" class="file-desc">interactive, no stack</text>

  <!-- pm step boxes (wider to hold long filenames) -->
  <rect x="652" y="332" width="200" height="44" rx="4" class="step-box"/>
  <text x="672" y="350" class="step-name">decompose-prd</text>
  <text x="660" y="366" class="step-detail">pm/github-project-manager.md</text>

  <line x1="852" y1="354" x2="874" y2="354" class="arrow-h"/>
  <polygon points="871,351 878,354 871,357" fill="#777"/>

  <rect x="878" y="332" width="170" height="44" rx="4" class="step-box"/>
  <text x="898" y="350" class="step-name">execute-tasks</text>
  <text x="886" y="366" class="step-detail">pm/github-issue.md</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- COMPOSITION FLOW  (y=450, h=270, bottom=720)              -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="620" y="450" width="270" height="270" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="640" y="476" class="dir-label">Composition Flow</text>

  <rect x="640" y="496" width="230" height="38" rx="5" fill="#1a1a1a" stroke="#484848" stroke-width="1"/>
  <text x="656" y="513" class="info-label">1. Workflow step</text>
  <text x="656" y="527" class="info-desc">prompt_file + inherited stack</text>

  <line x1="755" y1="534" x2="755" y2="548" class="connector"/>
  <polygon points="751,545 755,552 759,545" fill="#777"/>

  <rect x="640" y="552" width="230" height="38" rx="5" fill="#1a1a1a" stroke="#484848" stroke-width="1"/>
  <text x="656" y="569" class="info-label">2. Stack prompt</text>
  <text x="656" y="583" class="info-desc">rust, astro, aws, mise</text>

  <line x1="755" y1="590" x2="755" y2="604" class="connector"/>
  <polygon points="751,601 755,608 759,601" fill="#777"/>

  <rect x="640" y="608" width="230" height="38" rx="5" fill="#1a1a1a" stroke="#484848" stroke-width="1"/>
  <text x="656" y="625" class="info-label">3. Template resolution</text>
  <text x="656" y="639" class="info-desc">{{mission}}, {{worktree_path}}</text>

  <line x1="755" y1="646" x2="755" y2="666" class="connector"/>
  <polygon points="751,663 755,670 759,663" fill="#777"/>

  <rect x="705" y="672" width="120" height="28" rx="14" fill="#8a8"/>
  <text x="731" y="690" font-size="12" font-weight="600" fill="#111">Final Agent</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- TEMPLATE VARIABLES  (y=450, h=180, bottom=630)            -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="910" y="450" width="270" height="180" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="930" y="476" class="dir-label">Template Variables</text>

  <text x="930" y="502" class="file-name" font-size="11">{{mission}}</text>
  <text x="1070" y="502" class="info-desc">Task goal</text>

  <text x="930" y="524" class="file-name" font-size="11">{{prd}}</text>
  <text x="1070" y="524" class="info-desc">PRD document</text>

  <text x="930" y="546" class="file-name" font-size="11">{{worktree_path}}</text>
  <text x="1070" y="546" class="info-desc">Working dir</text>

  <text x="930" y="568" class="file-name" font-size="11">{{context}}</text>
  <text x="1070" y="568" class="info-desc">Project context</text>

  <text x="930" y="590" class="file-name" font-size="11">{{github_repo}}</text>
  <text x="1070" y="590" class="info-desc">owner/repo</text>

  <text x="930" y="612" class="file-name" font-size="11">{{github_issue}}</text>
  <text x="1070" y="612" class="info-desc">Issue number</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- TASK SIZING  (y=650, h=160, bottom=810)                   -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="910" y="650" width="270" height="160" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="930" y="676" class="dir-label">Task Sizing</text>

  <text x="930" y="698" class="info-label">XS</text>
  <text x="962" y="698" class="info-desc">&lt;30m, 1 file, config tweak</text>

  <text x="930" y="718" class="info-label">S</text>
  <text x="962" y="718" class="info-desc">30m-1h, 1-2 files</text>

  <text x="930" y="738" class="info-label">M</text>
  <text x="962" y="738" class="info-desc">1-2h, 2-5 files</text>

  <text x="930" y="758" class="info-label">L</text>
  <text x="962" y="758" class="info-desc">2-4h, 5+ files</text>

  <text x="930" y="778" class="info-label">XL</text>
  <text x="962" y="778" class="info-desc">4-8h, architectural scope</text>

  <text x="930" y="800" class="missing-desc">L/XL: decompose into smaller tasks</text>

  <!-- ══════════════════════════════════════════════════════════ -->
  <!-- PROGRESS  (y=830, h=50, bottom=880)                       -->
  <!-- ══════════════════════════════════════════════════════════ -->

  <rect x="20" y="830" width="1160" height="50" rx="8" fill="#161616" stroke="#383838" stroke-width="1"/>
  <text x="40" y="854" class="dir-label">Progress</text>
  <text x="130" y="854" class="subtitle">16 of 16 files  |  prompts: 14/14  |  workflows: 2/2</text>
  <rect x="40" y="864" width="1120" height="6" rx="3" fill="#222"/>
  <rect x="40" y="864" width="1120" height="6" rx="3" fill="#8a8"/>

</svg>
