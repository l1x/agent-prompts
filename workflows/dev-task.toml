[workflow]
name = "dev-task"
description = "Plan, implement, test, and review a development task"
version = "2.0.0"
stack = ["rust"]  # default stack for all steps; ["astro"], ["aws"], etc.

[workflow.inputs]
mission = { required = true }
worktree_path = { required = true }
github_issue = { required = true }
context = { required = false, default = "" }

[[steps]]
id = "plan"
prompt_file = "do/plan.md"

[[steps]]
id = "implement"
prompt_file = "do/implement.md"
depends_on = ["plan"]

[[steps]]
id = "qa"
prompt_file = "do/qa.md"
depends_on = ["implement"]

[[steps]]
id = "review"
prompt_file = "do/review.md"
depends_on = ["qa"]

[[steps]]
id = "fix"
prompt_file = "do/implement.md"
depends_on = ["review"]
condition = "review.verdict == 'FAIL'"
max_retries = 3
